<script type="text/html" data-template-name="MIIOsendcommand">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Put Node name here">
    </div>
    <div class="form-row">
        <label for="node-input-devices"><i class="fa fa-wifi"></i> Device</label>
        <input id="node-input-devices">
    </div>
    <div class="form-row">
        <label for="node-input-command"><i class="fa fa-tasks"></i> Command</label>
        <input type="text" id="node-input-command">
    </div>
    <div class="form-row">
        <label for="node-input-command_state"><i class="fa fa-tasks"></i> State</label>
        <input type="text" id="node-input-command_state">
        <input type="hidden" id="node-input-command_state-type">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('MIIOsendcommand',{
        category: 'mihome',
        color: '#00bc9c',
        defaults: {
            name: {value: ""},
            devices: {value: "", type: "MIIOdevices"},
            command: {value: ""},
            command_state: {value: "payload"},
        },
        inputs:1,
        outputs:1,
        icon: "mi.png",
        align: "left",
        label: function() {
            if (this.name) {
                return this.name + " - " + this.command || "Send Cmd";
            } else {
                return this.command || "Send Cmd";
            }
        },
        oneditprepare: OnMessage,
    });
        
    function OnMessage () {
        $("#node-input-command").typedInput({
            types: [
                {
                    value: "command",
                    options: [
                        { value: "Power", label: "‚èª Power"},
                        { value: "FanLevel", label: "‚ô® Fan Level"},
                        { value: "TargetHumidity", label: "‚ô® Target Humidity"},
                        { value: "TargetTemperature", label: "‚ÑÉ Target Temperature"},
                        { value: "Mode", label: "‚öô Mode"},
                        { value: "FavoriteLevel", label: "‚ù§ Favorite Level"},
                        { value: "FavLevel", label: "‚ù§ Fav Level"},
                        { value: "FavSpeed", label: "‚ù§ Favorite Speed"},
                        { value: "Led", label: "‚òâ Led - On/Off"},
                        { value: "LedB", label: "‚òâ Led B - On/Off"},
                        { value: "LedBrightness", label: "‚òâ Led - Brightness"},
                        { value: "Bright", label: "‚òâ Bright - On/Off"},
                        { value: "Display", label: "‚ñë Display - On/Off"},
                        { value: "LcdBrightness", label: "‚ñë Display - Brightness"},
                        { value: "Buzzer", label: "‚ô™ Sound - On/Off"},
                        { value: "Volume", label: "‚ô™ Sound - Volume"},
                        { value: "ChildLock", label: "üîí Child Lock"},
                    ]
                }
            ]
        });

        $("#node-input-command_state").typedInput({
            type:"msg",
            types:["msg"],
            typeField: "#node-input-command_state-type"
        })
    }    
</script>